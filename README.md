# EasyTalk

## О проекте

EasyTalk — это приложение для изучения английского языка, разрабатываемое как монорепозиторий с бекендом на FastAPI (Python) и будущим фронтендом на iOS (Swift/SwiftUI). Проект использует принципы Domain-Driven Design (DDD) и Clean Architecture, что обеспечивает чистое разделение бизнес-логики от инфраструктурных деталей.

## Архитектура проекта

Проект следует принципам Clean Architecture и разделяется на следующие слои:

### Доменный слой (Domain)
- Содержит бизнес-сущности и правила, не зависящие от внешних факторов
- Включает основные объекты (User, GameSession, Achievement) и их поведение
- Определяет интерфейсы для работы с репозиториями

### Слой приложения (Application)
- Содержит сценарии использования (use cases), которые реализуют бизнес-логику
- Определяет интерфейсы для инфраструктурных компонентов
- Взаимодействует с доменным слоем, но не имеет прямых зависимостей от инфраструктуры

### Инфраструктурный слой (Infrastructure)
- Реализует конкретные детали хранилищ данных (репозитории MongoDB)
- Содержит код для обработки HTTP-запросов (FastAPI контроллеры)
- Имплементирует аутентификацию и авторизацию (JWT)

## Функциональность

### Аутентификация и пользователи
- Регистрация и вход пользователей с использованием JWT-токенов
- Профили пользователей с отслеживанием прогресса
- Система уровней и опыта

### Игровые механики
- Различные типы языковых игр и упражнений
- Отслеживание прогресса в обучении
- Механизм сложности, адаптирующийся к уровню пользователя

### Система достижений
- Награды за достижение определенных целей
- Наборы опыта за завершенные задания
- Визуализация прогресса

## Технологический стек

### Бекенд
- **Python 3.13.2** — основной язык программирования
- **FastAPI** — высокопроизводительный веб-фреймворк
- **Pydantic** — валидация данных и сериализация
- **MongoDB** — NoSQL база данных
- **PyJWT** — работа с JWT-токенами для аутентификации
- **Uvicorn** — ASGI-сервер для запуска FastAPI приложений

### Фронтенд (планируется)
- **Swift/SwiftUI** для iOS-приложения

## Установка и запуск

### Требования
- Python 3.13.2 или выше
- MongoDB (установлена локально или через Docker)
- Менеджер зависимостей uv (рекомендуется) или pip

### Настройка окружения

1. Клонирование репозитория:
   ```bash
   git clone https://github.com/yourusername/easytalk.git
   cd easytalk
   ```

2. Создание и активация виртуального окружения:
   ```bash
   cd backend
   uv venv
   source .venv/bin/activate
   ```

3. Установка зависимостей:
   ```bash
   uv pip install -r requirements.txt
   uv pip install -e .
   ```

4. Настройка переменных окружения:
   ```bash
   # Файлы .env.dev и .env.test уже созданы, 
   # но нужно внести в них значения для ваших ключей
   ```

### Запуск сервера для разработки

```bash
cd backend
uv run uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

После запуска, API будет доступно по адресу: http://localhost:8000

Документация Swagger UI: http://localhost:8000/docs  
Альтернативная документация ReDoc: http://localhost:8000/redoc

## Структура проекта

```
/easytalk/
├── .git/               # Git-репозиторий
├── .gitignore          # Общие исключения для репозитория
├── README.md           # Этот файл с документацией
├── backend/            # Бэкенд на FastAPI
│   ├── app/            # Основной код приложения
│   │   ├── domain/             # Доменный слой
│   │   │   ├── entities/       # Сущности домена
│   │   │   └── value_objects/  # Значимые объекты
│   │   ├── application/        # Слой приложения 
│   │   │   ├── interfaces/     # Интерфейсы репозиториев
│   │   │   └── use_cases/      # Сценарии использования
│   │   ├── infrastructure/     # Инфраструктурный слой
│   │   │   ├── controllers/    # Контроллеры FastAPI
│   │   │   └── persistence/    # Реализации репозиториев
│   │   ├── config/             # Конфигурации
│   │   │   └── settings.py     # Настройки приложения
│   │   └── main.py             # Точка входа в приложение
│   ├── .env.dev        # Переменные окружения для разработки
│   ├── .env.test       # Переменные окружения для тестирования
│   ├── .gitignore      # Исключения для бэкенда
│   ├── scripts/        # Скрипты для запуска и настройки
│   ├── pyproject.toml  # Конфигурация проекта Python
│   └── requirements.txt # Зависимости проекта
└── ios/                # Будущий фронтенд на iOS (в разработке)
```

## API эндпоинты

### Аутентификация
- `POST /api/v1/auth/register` — регистрация нового пользователя
- `POST /api/v1/auth/login` — аутентификация и получение JWT-токена
- `GET /api/v1/auth/me` — получение информации о текущем пользователе

### Игры
- `GET /api/v1/games` — получение доступных игр
- `POST /api/v1/games/{game_id}/start` — начало игровой сессии
- `POST /api/v1/games/{game_id}/submit` — отправка ответов
- `GET /api/v1/games/{game_id}/result` — получение результатов

### Прогресс
- `GET /api/v1/progress` — получение общего прогресса пользователя
- `GET /api/v1/progress/achievements` — получение достижений пользователя
- `GET /api/v1/progress/statistics` — получение статистики обучения

## Внедрение зависимостей (Dependency Injection)

Проект активно использует внедрение зависимостей для обеспечения гибкости и тестируемости:

1. Use Cases получают репозитории через конструктор:
   ```python
   class AuthUseCase:
       def __init__(self, user_repository):
           self.user_repository = user_repository
   ```

2. FastAPI предоставляет встроенную систему зависимостей для защиты эндпоинтов:
   ```python
   @router.get("/me")
   async def get_user_info(current_user: User = Depends(get_current_active_user)):
       return current_user
   ```

## Запланированные улучшения

- Интеграция с Firebase для push-уведомлений
- Улучшенная аналитика прогресса обучения
- Система рекомендаций для персонализированного обучения
- Социальные функции (соревнования, рейтинги)
- iOS-приложение с интуитивным интерфейсом

## Разработка и тестирование

### Разработка новых функций
1. Создайте новую ветку от `main`
2. Внесите изменения, соблюдая принципы архитектуры
3. Напишите тесты для новых функций
4. Отправьте pull request

### Запуск тестов
```bash
cd backend
pytest
```

## Лицензия

Проект распространяется под лицензией MIT. Подробности см. в файле LICENSE.

## Контакты

Если у вас есть вопросы или предложения по проекту, свяжитесь с нами:
- GitHub: [ваш_github_аккаунт]
- Email: [ваш_email_адрес]
